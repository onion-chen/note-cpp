# 构造数据类型
结构体可以将不同的数据类型组合在一起，形成一个新的数据类型。结构体类型是对数据的整合，可以使代码更简洁。共用体（联合体）和结构体类似，它是一个存储空间可变的数据类型，可使程序设计更加灵活。枚举类型是特殊的常量，增加了代码的可读性。

## 1.结构体
### 1.1 结构体定义
整型、字符型、浮点型都属于基本类型，只能记录单一的数据。如果要描述一本书，通常要定义书名、价格、评分等多个不同的数据类型，非常麻烦，如果有一种类型可以将这些变量组合在一起，则会大大减少代码的离散性，结构体就是实现这一功能的类型。

**结构体定义：**
```cpp
#include<iostream>
using namespace std;
struct Book{
  char b_name[10]; // 书的名称10个字符
  double price;    // 书的价格
  int score;      //书的评分
}
```
其中，`struct`是定义结构体的关键字；结构体类型名是一个标识符，后续可用它定义具体的结构体变量，大括号内的是结构体的成员，每个成员都有自己单独的类型和内存空间。
:::tip 结构体与数组
结构体是由多个类型不同的数据组成的集合，而数组是由相同类型元素组成的集合。
:::

### 1.2 结构体的声明和初始化
1、先定义结构体类型，再声明结构体变量。
```cpp{3,9}
#include<iostream>
using namespace std;
struct Book {        // 定义结构体
	char b_name[10];
	double price;
	int socre;
};
int main() {
	Book b1 = { "《水浒传》", 19.9, 9 }; // 声明结构体变量，并初始化
	cout << "书籍名称为：" << b1.b_name << " 价格是：" << b1.price << " 评分为：" << b1.socre << endl;
	return 0;
}
```
2、定义结构体类型的同时声明结构体变量。
```cpp{8}
#include<iostream>
#include<string>
using namespace std;
struct Book {
	string b_name;
	double price;
	int score;
}b1, b2; // 定义结构体类型的同时声明结构体变量
int main() {
	b1.b_name = "《西游记》";
	b1.price = 19.9;
	b1.score = 10;
	cout << "书籍名称为：" << b1.b_name << " 价格是：" << b1.price << " 评分为：" << b1.score << endl;

	b2.b_name = "《三国演义》";
	b2.price = 20.9;
	b2.score = 20;
	cout << "书籍名称为：" << b2.b_name << " 价格是：" << b2.price << " 评分为：" << b2.score << endl;
	return 0;
}
```
3、省略结构体名称，直接声明结构体变量。
```cpp{4,8}
#include<iostream>
#include<string>
using namespace std;
struct { // 省略结构体名称
  string b_name;
  double price;
  int score;
}b1; // 直接声明结构体变量
int main () {
  b1.b_name = "《红楼梦》";
  b1.price = 19.9;
  b1.score = 10;
	cout << "书籍名称为：" << b1.b_name << " 价格是：" << b1.price << " 评分为：" << b1.score << endl;
  return 0;
}
```
4、结构体变量在声明时直接进行初始化。
```cpp{7}
#include<iostream>
using namespace std;
struct Book {
	char b_name[20];
	double price;
	int score;
}b1 = { "《地下城与勇士》", 29.9, 10 }; // 结构体变量在声明时直接进行初始化。
int main() {
	cout << "书籍名称为：" << b1.b_name << " 价格是：" << b1.price << " 评分为：" << b1.score << endl;
	return 0;
}
```
### 1.3 结构体成员引用
引用结构体成员的方式有两种：使用成员运算符“.”和使用指向运算符“->”。

**1.使用成员运算符.：**

与前一小节的使用方式一致。

**2.使用指向运算符->：**

使用结构体，还可以定义指针变量，让一个指针指向该结构体。此时，该结构体成员的引用需要使用指向运算符`->`。
```cpp{12}
#include<iostream>
#include<string>
using namespace std;
struct Book {
	string b_name;
	double price;
	int score;
};
int main() {
	Book b = { "《天空之城的乐章》", 39.9, 10 };
	Book* b1 = &b;
	cout << "书籍名称为：" << b1->b_name << " 价格是：" << b1->price << " 评分为：" << b1->score << endl;
	return 0;
}
```
:::warning
并不是所有的结构体成员都可以赋值，如果某个结构体变量的某个成员使用`const`限定，就不能对它赋值。

结构体指针变量只有初始化之后才可以使用。
:::

### 1.4 结构体嵌套
C++中允许在结构体中继续定义结构体。

1、在结构体中嵌套其他已经定义好的结构体变量。
```cpp{12}
#include<iostream>
#include<string>
using namespace std;
struct Behaviour {
  void eating(string food) {
    cout << "Dogs like to eat " << food << endl;
  }
};
struct Dog {
  char d_name[20];
  int age;
  Behaviour b; // 在结构体中嵌套其他已经定义好的结构体变量。
};
int main() {
  Dog d = {"小黑", 2};
  cout << "小狗名字是：" << d.d_name << " 小狗的年龄是：" << d.age << endl;
  d.b.eating("bones");
  return 0;
}
```
2、直接在结构体中定义结构体。
```cpp{7}
#include<iostream>
#include<string>
using namespace std;
struct Dog {
    string d_name;
    int age;
    struct Behaviour { // 直接在结构体中定义结构体。
        void eating(string food) {
            cout << "Dogs like to eat " << food << endl;
        };
    } b;
};
int main() {
    Dog d = { "小黑", 2 };
    cout << "小狗名字是：" << d.d_name << " 小狗的年龄是：" << d.age << endl;
    d.b.eating("bones");
    return 0;
}
```
## 2. 结构体与函数
### 2.1 结构体变量做函数参数
结构体可以作为函数的参数，减少函数参数的个数。
```cpp{8}
#include<iostream>
#include<string>
using namespace std;
struct Book {
	string name;
	double price;
	double score;
} b1 = { "《格兰之森的秘密》", 28.9, 8.3 }; // 初始化结构体
void printBook(Book b) {
	cout << "书籍名称：" << b.name << " 书籍的价格：" << b.price << " 书籍的评分：" << b.score;
}
int main() {
	printBook(b1); // 结构体变量做函数参数
	return 0;
}
```
### 2.2 结构体指针做函数参数
使用结构体指针做函数参数时，传递的只是地址，减少时间和空间的开销，显著提升运行效率。
```cpp{11}
#include<iostream>
#include<string>
using namespace std;
struct Book {
    string name;
    double price;
    double score;
};
void printBook(Book* b) {
    //访问结构体的成员变量
    cout << "书籍名称：" << b->name << " 书籍的价格：" << b->price << " 书籍的评分：" << b->score;
}
int main() {
    Book b = { "《雷霆废墟的终章》", 39.89, 9.3 };
    Book* b1 = &b;
    printBook(b1);
    return 0;
}
```
## 3. 结构体数组
如果一个数组中的元素都是结构体，这样的数组称为结构体数组。
### 3.1 结构体数组的声明和初始化
1、先定义结构体类型，再声明结构体数组。
```cpp{4,12}
#include<iostream>
#include<string>
using namespace std;
struct Book { // 先定义结构体类型
    string name;
    double price;
    double score;
};
int main() {
    Book b1 = { "《烈焰格拉克的序章》", 38.81, 8.9 };
    Book b2 = { "《冰霜格拉克的序章》", 38.81, 8.9 };
    Book arr[2] = { b1, b2 }; // 声明结构体数组
    for (int i = 0; i < 2; ++i) {
        cout << "书籍名称：" << arr[i].name << " 书籍的价格：" << arr[i].price << " 书籍的评分：" << arr[i].score << endl;
    }
    return 0;
}
```
2、定义结构体的同时声明结构体数组。
```cpp{8,10,11}
#include<iostream>
#include<string>
using namespace std;
struct Book {
    string name;
    double price;
    double score;
}books[2]; // 定义结构体的同时声明结构体数组
int main() {
    books[0] = { "《烈焰格拉克的序章》", 38.81, 8.9 }; // 给数组元素赋值
    books[1] = { "《冰霜格拉克的序章》", 38.81, 8.9 }; // 给数组元素赋值
    for (int i = 0; i < 2; ++i) {
        cout << "书籍名称：" << books[i].name << " 书籍的价格：" << books[i].price << " 书籍的评分：" << books[i].score << endl;
    }
    return 0;
}
```
3、省略结构体名称直接声明结构体数组。
```cpp{4,8}
#include<iostream>
#include<string>
using namespace std;
struct {        // 省略结构体名称
    string name;
    double price;
    double score;
}books[2]; // 直接声明结构体数组
int main() {
    books[0] = { "《烈焰格拉克的序章》", 38.81, 8.9 }; // 给数组元素赋值
    books[1] = { "《冰霜格拉克的序章》", 38.81, 8.9 }; // 给数组元素赋值
    for (int i = 0; i < 2; ++i) {
        cout << "书籍名称：" << books[i].name << " 书籍的价格：" << books[i].price << " 书籍的评分：" << books[i].score << endl;
    }
    return 0;
}
```
4、声明结构体数组时，直接对数组进行初始化。
```cpp{8}
#include<iostream>
#include<string>
using namespace std;
struct {
    string name;
    double price;
    double score;
}books[2] = { // 声明结构体数组时，直接对数组进行初始化。
  { "《烈焰格拉克的序章》", 38.81, 8.9 },
  { "《冰霜格拉克的序章》", 38.81, 8.9 }
};
int main() {
    for (int i = 0; i < 2; ++i) {
        cout << "书籍名称：" << books[i].name << " 书籍的价格：" << books[i].price << " 书籍的评分：" << books[i].score << endl;
    }
    return 0;
}
```
